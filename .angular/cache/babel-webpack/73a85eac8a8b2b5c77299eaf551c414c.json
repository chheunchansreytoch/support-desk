{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { FormControl, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { AlertInformationDialogComponent } from '../../alert-information-dialog/alert-information-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/stores/case.store\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"src/app/stores/agent.store\";\nimport * as i4 from \"src/app/stores/agentDepartment.store\";\nimport * as i5 from \"src/app/stores/status.store\";\nimport * as i6 from \"src/app/stores/priority.store\";\nimport * as i7 from \"@angular/forms\";\nexport let CreateCaseDialogComponent = /*#__PURE__*/(() => {\n  class CreateCaseDialogComponent {\n    constructor(caseStore, dialog, agentStore, agentDepartmentStore, statusStore, priorityStore, formBuilder, dialogRef, data) {\n      this.caseStore = caseStore;\n      this.dialog = dialog;\n      this.agentStore = agentStore;\n      this.agentDepartmentStore = agentDepartmentStore;\n      this.statusStore = statusStore;\n      this.priorityStore = priorityStore;\n      this.formBuilder = formBuilder;\n      this.dialogRef = dialogRef;\n      this.data = data;\n      this.arrAgentDepartments = [];\n      this.arrAgentsByDepartments = [];\n      this.arrStatuses = [];\n      this.arrPriorities = [];\n      this.getDepartmentIdFromFormData = '';\n      this.registrationForm = formBuilder.group({\n        caseNumber: new FormControl('', Validators.required),\n        status: new FormControl('New', Validators.required),\n        priority: new FormControl('High', Validators.required),\n        agentDepartment: new FormControl('', Validators.required),\n        agent: new FormControl('', Validators.required),\n        subject: new FormControl('', Validators.required),\n        description: new FormControl('', Validators.required)\n      }, {});\n    }\n\n    ngOnInit() {}\n\n    formSubmitted(formData) {\n      var _a;\n\n      return __awaiter(this, void 0, void 0, function* () {\n        if (this.registrationForm.valid) {\n          this.registrationForm.disable();\n          const {\n            caseNumber,\n            status,\n            priority,\n            agentDepartment,\n            agent,\n            subject,\n            description\n          } = formData;\n\n          if (!this.data) {\n            const fd = new FormData();\n            fd.append('caseNumber', caseNumber);\n            fd.append('status', status);\n            fd.append('priority', priority);\n            fd.append('agentDepartment', agentDepartment);\n            fd.append('agent', agent);\n            fd.append('subject', subject);\n            fd.append('description', description); // fd.append('description', this.description?.item(0) as any, this.selectedProfiles?.item(0)?.name);\n            // fd.append('createdBy', this.managerStore.getCurrentUser.id)\n\n            yield this.caseStore.addCase_FormData(fd);\n          } else {\n            const fd = new FormData();\n            fd.append('caseNumber', caseNumber);\n            fd.append('status', status);\n            fd.append('priority', priority);\n            fd.append('agentDepartment', agentDepartment);\n            fd.append('agent', agent);\n            fd.append('subject', subject);\n            fd.append('description', description);\n            yield this.caseStore.updateCaseFormData((_a = this.data) === null || _a === void 0 ? void 0 : _a.id, fd);\n          }\n\n          this.registrationForm.enable();\n          this.registrationForm.reset();\n          this.dialog.open(AlertInformationDialogComponent, {\n            width: '500px',\n            data: {\n              title: this.data ? 'Update Agent' : 'Create Agent',\n              type: 'success',\n              content: this.data ? `Agent is updated.` : `Agent is created.`\n            },\n            disableClose: true\n          });\n        }\n\n        return;\n      });\n    }\n\n    fetchAgentsDepartment() {\n      this.agentDepartmentStore.getAgentDepartments().subscribe(res => {\n        this.arrAgentDepartments = res;\n      });\n    }\n\n    fetchAgentsByDepartment() {\n      this.agentStore.getAgentsByDepartment(this.getDepartmentIdFromFormData).then(res => {\n        this.arrAgentsByDepartments = res;\n      });\n    }\n\n    fetchStatuses() {\n      this.statusStore.getStatuses().subscribe(res => {\n        this.arrStatuses = res;\n      });\n    }\n\n    fetchPriorities() {\n      this.priorityStore.getPriorities().subscribe(res => {\n        this.arrPriorities = res;\n      });\n    }\n\n  }\n\n  CreateCaseDialogComponent.ɵfac = function CreateCaseDialogComponent_Factory(t) {\n    return new (t || CreateCaseDialogComponent)(i0.ɵɵdirectiveInject(i1.CaseStore), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.AgentStore), i0.ɵɵdirectiveInject(i4.AgentDepartmentStore), i0.ɵɵdirectiveInject(i5.StatusStore), i0.ɵɵdirectiveInject(i6.PriorityStore), i0.ɵɵdirectiveInject(i7.FormBuilder), i0.ɵɵdirectiveInject(i2.MatDialogRef), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA));\n  };\n\n  CreateCaseDialogComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CreateCaseDialogComponent,\n    selectors: [[\"app-create-case-dialog\"]],\n    decls: 0,\n    vars: 0,\n    template: function CreateCaseDialogComponent_Template(rf, ctx) {},\n    styles: [\"\"]\n  });\n  return CreateCaseDialogComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}